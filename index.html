<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CV Creator by Nikita Lorusso</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome & Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Poppins:wght@300;400;600;700&family=Merriweather:wght@300;400;700&family=Roboto+Mono:wght@400&display=swap" rel="stylesheet">

    <style>
        /* --- RESET GLOBALE --- */
        #cv-widget-root { font-family: 'Inter', sans-serif; color: #1e293b; line-height: 1.5; background: #f1f5f9; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        #cv-widget-root * { box-sizing: border-box; }

        /* --- LAYOUT RESPONSIVE --- */
        .main-area { display: flex; flex: 1; overflow: hidden; position: relative; }
        
        /* Pannello Editor (Sinistra) */
        .editor-panel { width: 400px; background: white; border-right: 1px solid #e2e8f0; display: flex; flex-direction: column; z-index: 20; box-shadow: 5px 0 15px rgba(0,0,0,0.05); }
        .editor-content { flex: 1; overflow-y: auto; padding: 20px; }
        
        /* Pannello Anteprima (Destra) */
        .preview-panel { flex: 1; background: #94a3b8; display: flex; justify-content: center; padding: 40px; overflow-y: auto; position: relative; }
        
        /* --- FOGLIO A4 (Il cuore) --- */
        .cv-paper {
            width: 210mm;
            min-height: 297mm; /* Altezza A4 */
            background: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            transform-origin: top center;
            /* Importante per non tagliare contenuti */
            height: auto; 
            overflow: hidden;
        }

        /* Gestione Barra Laterale "Infinita" */
        .cv-sidebar-layout {
            display: flex;
            min-height: 297mm; /* Assicura che il flex container copra tutta la pagina */
            height: 100%;
        }
        .cv-col-left {
            width: 35%;
            background-color: var(--sidebar-bg, #1e293b);
            color: var(--sidebar-text, white);
            min-height: 100%; /* Forza l'altezza */
            flex-shrink: 0;
        }
        .cv-col-right {
            width: 65%;
            background-color: white;
            flex-grow: 1;
        }

        /* --- MOBILE MODE --- */
        .mobile-nav { display: none; }

        @media (max-width: 900px) {
            #cv-widget-root { height: auto; min-height: 100vh; }
            .main-area { flex-direction: column; height: auto; padding-bottom: 70px; } /* Spazio per nav */
            
            .editor-panel { width: 100%; height: auto; border-right: none; display: none; }
            .editor-panel.active { display: flex; }
            
            .preview-panel { width: 100%; height: auto; display: none; padding: 10px; background: #e2e8f0; }
            .preview-panel.active { display: flex; }
            
            .cv-paper { transform: scale(1) !important; width: 100% !important; min-height: auto; box-shadow: none; }

            .mobile-nav { 
                display: flex; position: fixed; bottom: 0; left: 0; width: 100%; 
                background: white; border-top: 1px solid #e2e8f0; z-index: 100; 
                justify-content: space-around; padding: 10px; box-shadow: 0 -5px 10px rgba(0,0,0,0.05);
            }
            .mob-btn { flex: 1; text-align: center; font-size: 10px; color: #64748b; font-weight: 600; background: none; border: none; }
            .mob-btn i { display: block; font-size: 18px; margin-bottom: 3px; }
            .mob-btn.active { color: #2563eb; }
        }

        /* --- STAMPA PDF (FIX DEFINITIVO) --- */
        @media print {
            /* Nascondi tutto tranne il foglio */
            body > *:not(#cv-print-container) { display: none !important; }
            #cv-widget-root { display: none !important; }
            
            /* Contenitore di stampa speciale */
            #cv-print-container {
                display: block !important;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                margin: 0;
                padding: 0;
                z-index: 9999;
            }

            /* Configurazione Foglio in stampa */
            .cv-paper {
                box-shadow: none !important;
                margin: 0 !important;
                width: 100% !important;
                min-height: 100vh !important; /* Forza altezza pagina intera */
                height: auto !important;
                page-break-after: auto;
                transform: none !important; /* Rimuovi zoom JS */
                
                /* Forza Background Colori */
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                background-color: white !important;
            }

            /* Forza altezza colonne */
            .cv-sidebar-layout, .cv-col-left {
                height: 100% !important;
                min-height: 100vh !important; 
            }

            @page { margin: 0; size: auto; }
        }
        
        /* Utility Classes per JS */
        .hidden { display: none !important; }
    </style>
</head>
<body>

<!-- APP ROOT -->
<div id="cv-widget-root">
    
    <!-- HEADER -->
    <header class="bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center z-30 shrink-0">
        <div class="flex items-center gap-2">
            <div class="bg-blue-600 text-white w-8 h-8 rounded-lg flex items-center justify-center font-bold text-lg">CV</div>
            <div>
                <h1 class="text-sm font-bold text-slate-800 leading-tight">Creator</h1>
                <a href="https://www.nikitalorusso.it" target="_blank" class="text-[10px] text-blue-600 hover:underline uppercase tracking-wider font-bold">by Nikita Lorusso</a>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="cvApp.reset()" class="bg-slate-100 text-slate-600 px-3 py-2 rounded-lg text-xs font-bold hover:bg-slate-200 transition-colors">
                <i class="fa-solid fa-trash-can sm:mr-1"></i> <span class="hidden sm:inline">Reset</span>
            </button>
            <button onclick="cvApp.print()" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-blue-700 transition-colors shadow-lg flex items-center gap-2">
                <i class="fa-solid fa-download"></i> Scarica PDF
            </button>
        </div>
    </header>

    <div class="main-area">
        
        <!-- EDITOR -->
        <div id="editor-panel" class="editor-panel active">
            <!-- TABS EDITOR -->
            <div class="flex border-b border-gray-200 bg-slate-50">
                <button onclick="cvApp.setTab('content')" id="tab-content" class="flex-1 py-3 text-xs font-bold uppercase text-blue-600 border-b-2 border-blue-600 bg-white">Dati</button>
                <button onclick="cvApp.setTab('design')" id="tab-design" class="flex-1 py-3 text-xs font-bold uppercase text-slate-500 hover:text-slate-700">Design</button>
            </div>

            <div class="editor-content custom-scrollbar">
                
                <!-- PANNELLO DATI -->
                <div id="view-content" class="space-y-6">
                    <!-- Foto -->
                    <div class="bg-blue-50 p-3 rounded-lg border border-blue-100 flex items-center gap-3">
                        <div id="ui-photo" class="w-12 h-12 rounded-full bg-white border-2 border-blue-200 overflow-hidden flex items-center justify-center text-blue-200">
                            <i class="fa-solid fa-user"></i>
                        </div>
                        <div class="flex-1 flex gap-2">
                            <button onclick="document.getElementById('upl').click()" class="bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded flex-1">Carica Foto</button>
                            <button onclick="cvApp.delPhoto()" class="bg-white border border-red-200 text-red-500 text-xs font-bold px-3 py-1.5 rounded flex-1">Rimuovi</button>
                            <input type="file" id="upl" hidden accept="image/*" onchange="cvApp.addPhoto(this)">
                        </div>
                    </div>

                    <!-- Input -->
                    <div class="space-y-3">
                        <input type="text" data-key="name" placeholder="Nome Completo" class="w-full p-2.5 border rounded text-sm font-bold">
                        <input type="text" data-key="title" placeholder="Titolo (es. Web Designer)" class="w-full p-2.5 border rounded text-sm">
                        <div class="grid grid-cols-2 gap-2">
                            <input type="text" data-key="email" placeholder="Email" class="p-2.5 border rounded text-sm">
                            <input type="text" data-key="phone" placeholder="Telefono" class="p-2.5 border rounded text-sm">
                        </div>
                        <input type="text" data-key="location" placeholder="Città" class="w-full p-2.5 border rounded text-sm">
                        <textarea data-key="summary" rows="3" placeholder="Profilo professionale..." class="w-full p-2.5 border rounded text-sm resize-none"></textarea>
                    </div>

                    <!-- Liste -->
                    <div class="space-y-4">
                        <div class="flex justify-between items-center border-b pb-1">
                            <span class="text-xs font-bold uppercase text-slate-400">Esperienza</span>
                            <button onclick="cvApp.addList('exp')" class="text-blue-600 text-xs font-bold">+ Aggiungi</button>
                        </div>
                        <div id="ui-exp-list" class="space-y-2"></div>

                        <div class="flex justify-between items-center border-b pb-1">
                            <span class="text-xs font-bold uppercase text-slate-400">Istruzione</span>
                            <button onclick="cvApp.addList('edu')" class="text-blue-600 text-xs font-bold">+ Aggiungi</button>
                        </div>
                        <div id="ui-edu-list" class="space-y-2"></div>
                    </div>

                    <!-- Skills -->
                    <div>
                        <span class="text-xs font-bold uppercase text-slate-400 block mb-1">Competenze (separate da virgola)</span>
                        <textarea data-key="skills" rows="2" class="w-full p-2.5 border rounded text-sm resize-none"></textarea>
                    </div>
                </div>

                <!-- PANNELLO DESIGN -->
                <div id="view-design" class="hidden space-y-6">
                    <div>
                        <span class="text-xs font-bold uppercase text-slate-400 block mb-2">Template</span>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="cvApp.setTpl('modern')" class="border-2 border-blue-600 bg-blue-50 p-2 rounded text-center text-xs font-bold text-blue-700 tpl-btn" id="btn-tpl-modern">Moderno</button>
                            <button onclick="cvApp.setTpl('classic')" class="border-2 border-gray-200 p-2 rounded text-center text-xs font-bold text-gray-500 tpl-btn" id="btn-tpl-classic">Classico</button>
                        </div>
                    </div>
                    
                    <div>
                        <span class="text-xs font-bold uppercase text-slate-400 block mb-2">Colori</span>
                        <div class="flex items-center justify-between p-2 border rounded mb-2">
                            <span class="text-xs font-bold">Colore Principale</span>
                            <input type="color" oninput="cvApp.setColor('accent', this.value)" value="#2563eb" class="w-8 h-8 rounded cursor-pointer">
                        </div>
                        <div class="flex items-center justify-between p-2 border rounded">
                            <span class="text-xs font-bold">Sfondo Colonna</span>
                            <input type="color" oninput="cvApp.setColor('bg', this.value)" value="#1e293b" class="w-8 h-8 rounded cursor-pointer">
                        </div>
                    </div>

                    <div>
                        <span class="text-xs font-bold uppercase text-slate-400 block mb-2">Font</span>
                        <select onchange="cvApp.setFont(this.value)" class="w-full p-2 border rounded text-sm bg-white">
                            <option value="Inter, sans-serif">Inter</option>
                            <option value="Poppins, sans-serif">Poppins</option>
                            <option value="Merriweather, serif">Merriweather</option>
                        </select>
                    </div>
                </div>

                <!-- Call to Action Nikita -->
                <div class="mt-8 pt-4 border-t border-gray-200 text-center">
                    <p class="text-xs text-slate-500 mb-2">Hai bisogno di un sito web professionale?</p>
                    <a href="https://www.nikitalorusso.it" target="_blank" class="block w-full bg-slate-900 text-white text-xs font-bold py-3 rounded-lg hover:bg-slate-800 transition-colors">
                        Contatta Nikita Lorusso <i class="fa-solid fa-arrow-right ml-1"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- ANTEPRIMA -->
        <div id="preview-panel" class="preview-panel">
            <!-- Il CV viene iniettato qui -->
            <div id="cv-container"></div>
        </div>

    </div>

    <!-- MOBILE NAV -->
    <div class="mobile-nav">
        <button onclick="cvApp.mob('data')" class="mob-btn active" id="mob-data"><i class="fa-solid fa-pen"></i>Dati</button>
        <button onclick="cvApp.mob('design')" class="mob-btn" id="mob-design"><i class="fa-solid fa-palette"></i>Design</button>
        <button onclick="cvApp.mob('preview')" class="mob-btn" id="mob-view"><i class="fa-solid fa-eye"></i>Anteprima</button>
    </div>

</div>

<!-- CONTENITORE STAMPA NASCOSTO -->
<div id="cv-print-container"></div>

<script>
    const cvApp = {
        data: {
            name: 'Mario Rossi', title: 'Digital Marketer', email: 'mario@email.com', phone: '333 1234567', location: 'Roma', summary: 'Esperto di strategie digitali.',
            skills: 'SEO, SEM, Social Media, Analytics',
            exp: [{id:1, role:'Manager', company:'Azienda', start:'2020', end:'Oggi', desc:'Gestione team.'}],
            edu: [{id:1, degree:'Laurea', school:'Università', year:'2019'}],
            photo: null,
            config: { template: 'modern', accent: '#2563eb', bg: '#1e293b', font: 'Inter, sans-serif' }
        },

        init() {
            const s = localStorage.getItem('nikita_cv_final');
            if(s) try { this.data = {...this.data, ...JSON.parse(s)}; } catch(e){}
            this.bind(); this.renderLists(); this.updatePhoto(); this.render();
            // Auto Zoom per Desktop
            window.addEventListener('resize', () => this.zoom());
            setTimeout(() => this.zoom(), 500);
        },

        save() {
            localStorage.setItem('nikita_cv_final', JSON.stringify(this.data));
            this.render();
        },

        bind() {
            document.querySelectorAll('[data-key]').forEach(el => {
                el.value = this.data[el.dataset.key] || '';
                el.oninput = (e) => { this.data[el.dataset.key] = e.target.value; this.save(); };
            });
        },

        // --- FOTO ---
        addPhoto(el) {
            if(el.files[0]) {
                const r = new FileReader();
                r.onload = (e) => { this.data.photo = e.target.result; this.updatePhoto(); this.save(); };
                r.readAsDataURL(el.files[0]);
            }
        },
        delPhoto() { this.data.photo = null; this.updatePhoto(); this.save(); },
        updatePhoto() {
            const el = document.getElementById('ui-photo');
            el.innerHTML = this.data.photo ? `<img src="${this.data.photo}" class="w-full h-full object-cover">` : `<i class="fa-solid fa-user"></i>`;
        },

        // --- LISTE ---
        addList(t) {
            this.data[t].unshift({id: Date.now(), role:'Ruolo', degree:'Titolo', company:'Ente', school:'Scuola', start:'', end:'', year:'', desc:''});
            this.renderLists(); this.save();
        },
        delList(t, id) {
            if(confirm('Eliminare?')) { this.data[t] = this.data[t].filter(i=>i.id!==id); this.renderLists(); this.save(); }
        },
        updList(t, id, k, v) { this.data[t].find(i=>i.id===id)[k] = v; this.save(); },
        renderLists() {
            ['exp', 'edu'].forEach(t => {
                const isExp = t==='exp';
                document.getElementById(`ui-${t}-list`).innerHTML = this.data[t].map(i => `
                    <div class="bg-white border p-2 rounded mb-2 relative">
                        <button onclick="cvApp.delList('${t}', ${i.id})" class="absolute top-2 right-2 text-red-400 text-xs"><i class="fa-solid fa-trash"></i></button>
                        <input class="w-full font-bold text-sm outline-none mb-1" value="${i[isExp?'role':'degree']}" oninput="cvApp.updList('${t}', ${i.id}, '${isExp?'role':'degree'}', this.value)" placeholder="Titolo">
                        <input class="w-full text-xs text-gray-500 outline-none mb-1" value="${i[isExp?'company':'school']}" oninput="cvApp.updList('${t}', ${i.id}, '${isExp?'company':'school'}', this.value)" placeholder="Ente">
                        <div class="flex gap-2 mb-1">
                            ${isExp ? 
                                `<input class="w-1/2 bg-slate-50 text-xs p-1 rounded" value="${i.start}" oninput="cvApp.updList('${t}', ${i.id}, 'start', this.value)" placeholder="Da">
                                 <input class="w-1/2 bg-slate-50 text-xs p-1 rounded" value="${i.end}" oninput="cvApp.updList('${t}', ${i.id}, 'end', this.value)" placeholder="A">` :
                                `<input class="w-full bg-slate-50 text-xs p-1 rounded" value="${i.year}" oninput="cvApp.updList('${t}', ${i.id}, 'year', this.value)" placeholder="Anno">`
                            }
                        </div>
                        ${isExp ? `<textarea class="w-full text-xs bg-slate-50 p-1 rounded resize-none" rows="2" oninput="cvApp.updList('${t}', ${i.id}, 'desc', this.value)" placeholder="Descrizione">${i.desc}</textarea>` : ''}
                    </div>
                `).join('');
            });
        },

        // --- DESIGN ---
        setTpl(t) {
            this.data.config.template = t;
            document.querySelectorAll('.tpl-btn').forEach(b => {
                b.className = "border-2 border-gray-200 p-2 rounded text-center text-xs font-bold text-gray-500 tpl-btn";
            });
            document.getElementById('btn-tpl-'+t).className = "border-2 border-blue-600 bg-blue-50 p-2 rounded text-center text-xs font-bold text-blue-700 tpl-btn";
            this.save();
        },
        setColor(k, v) { this.data.config[k === 'accent' ? 'accent' : 'bg'] = v; this.save(); },
        setFont(v) { this.data.config.font = v; this.save(); },

        // --- RENDER CV ---
        render() {
            const d = this.data;
            const c = d.config;
            const skills = d.skills.split(',').filter(s=>s.trim());
            
            let html = '';
            
            // Variabili CSS Inline per garantire la stampa
            const styleVars = `
                --sidebar-bg: ${c.bg};
                --accent: ${c.accent};
                font-family: ${c.font};
            `;

            // TEMPLATE MODERN (Sidebar)
            if(c.template === 'modern') {
                html = `
                <div class="cv-paper cv-sidebar-layout" style="${styleVars}">
                    <div class="cv-col-left p-8 flex flex-col">
                        <div class="text-center mb-8">
                            ${d.photo ? `<img src="${d.photo}" style="width:120px; height:120px; border-radius:50%; object-fit:cover; border:4px solid rgba(255,255,255,0.2); margin:0 auto 15px;">` : ''}
                            <h1 style="font-size:24px; font-weight:bold; line-height:1.2;">${d.name}</h1>
                            <p style="opacity:0.8; font-size:14px; margin-top:5px; text-transform:uppercase;">${d.title}</p>
                        </div>
                        <div style="font-size:13px; line-height:2; margin-bottom:30px;">
                            <div>${d.email}</div>
                            <div>${d.phone}</div>
                            <div>${d.location}</div>
                        </div>
                        <div style="margin-top:auto">
                            <h3 style="font-size:12px; font-weight:bold; text-transform:uppercase; border-bottom:1px solid rgba(255,255,255,0.2); padding-bottom:5px; margin-bottom:10px;">Competenze</h3>
                            <div style="display:flex; flex-wrap:wrap; gap:5px;">
                                ${skills.map(s => `<span style="background:rgba(255,255,255,0.1); padding:2px 6px; border-radius:4px; font-size:11px;">${s.trim()}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="cv-col-right p-10">
                        <section style="margin-bottom:30px;">
                            <h3 style="color:${c.accent}; font-weight:bold; text-transform:uppercase; border-bottom:2px solid #eee; padding-bottom:5px; margin-bottom:10px;">Profilo</h3>
                            <p style="font-size:14px; color:#333;">${d.summary}</p>
                        </section>
                        <section style="margin-bottom:30px;">
                            <h3 style="color:${c.accent}; font-weight:bold; text-transform:uppercase; border-bottom:2px solid #eee; padding-bottom:5px; margin-bottom:10px;">Esperienza</h3>
                            ${d.exp.map(e => `
                                <div style="margin-bottom:15px;">
                                    <div style="font-weight:bold; font-size:16px;">${e.role}</div>
                                    <div style="display:flex; justify-content:space-between; font-size:13px; color:${c.accent}; margin-bottom:3px;">
                                        <span>${e.company}</span><span>${e.start} - ${e.end}</span>
                                    </div>
                                    <p style="font-size:13px; color:#555;">${e.desc}</p>
                                </div>
                            `).join('')}
                        </section>
                        <section>
                            <h3 style="color:${c.accent}; font-weight:bold; text-transform:uppercase; border-bottom:2px solid #eee; padding-bottom:5px; margin-bottom:10px;">Istruzione</h3>
                            ${d.edu.map(e => `
                                <div style="margin-bottom:10px;">
                                    <div style="font-weight:bold; font-size:14px;">${e.degree}</div>
                                    <div style="font-size:13px; color:#666;">${e.school}, ${e.year}</div>
                                </div>
                            `).join('')}
                        </section>
                    </div>
                </div>`;
            }
            // TEMPLATE CLASSIC
            else {
                html = `
                <div class="cv-paper p-12" style="${styleVars}">
                    <div style="text-align:center; border-bottom:2px solid #333; padding-bottom:20px; margin-bottom:30px;">
                        <h1 style="font-size:32px; font-weight:bold; text-transform:uppercase;">${d.name}</h1>
                        <p style="color:${c.accent}; font-size:18px; margin-top:5px;">${d.title}</p>
                        <div style="font-size:14px; color:#666; margin-top:10px;">
                            ${d.email} | ${d.phone} | ${d.location}
                        </div>
                    </div>
                    <section style="margin-bottom:25px;">
                        <h3 style="font-size:14px; font-weight:bold; text-transform:uppercase; color:#999; letter-spacing:1px; margin-bottom:10px;">Profilo</h3>
                        <p style="font-size:14px;">${d.summary}</p>
                    </section>
                    <section style="margin-bottom:25px;">
                        <h3 style="font-size:14px; font-weight:bold; text-transform:uppercase; color:#999; letter-spacing:1px; margin-bottom:10px;">Esperienza</h3>
                        ${d.exp.map(e => `
                            <div style="display:flex; margin-bottom:15px;">
                                <div style="width:120px; font-weight:bold; font-size:12px; color:${c.accent};">${e.start} - ${e.end}</div>
                                <div>
                                    <div style="font-weight:bold; font-size:15px;">${e.role}</div>
                                    <div style="font-size:13px; font-style:italic; color:#666;">${e.company}</div>
                                    <p style="font-size:13px; margin-top:3px;">${e.desc}</p>
                                </div>
                            </div>
                        `).join('')}
                    </section>
                    <div style="display:flex; gap:20px;">
                        <section style="flex:1;">
                            <h3 style="font-size:14px; font-weight:bold; text-transform:uppercase; color:#999; letter-spacing:1px; margin-bottom:10px;">Istruzione</h3>
                            ${d.edu.map(e => `<div style="margin-bottom:8px;"><div style="font-weight:bold; font-size:14px;">${e.degree}</div><div style="font-size:12px;">${e.school}, ${e.year}</div></div>`).join('')}
                        </section>
                        <section style="flex:1;">
                            <h3 style="font-size:14px; font-weight:bold; text-transform:uppercase; color:#999; letter-spacing:1px; margin-bottom:10px;">Skills</h3>
                            <div style="font-size:13px;">${d.skills}</div>
                        </section>
                    </div>
                </div>`;
            }

            // Inietta in anteprima E nel contenitore di stampa
            document.getElementById('cv-container').innerHTML = html;
            document.getElementById('cv-print-container').innerHTML = html;
        },

        // --- AZIONI ---
        print() {
            window.print();
        },
        reset() {
            if(confirm('Cancellare tutto?')) {
                localStorage.removeItem('nikita_cv_final');
                location.reload();
            }
        },
        
        // --- UI ---
        setTab(t) {
            document.getElementById('view-content').classList.add('hidden');
            document.getElementById('view-design').classList.add('hidden');
            document.getElementById('view-'+(t==='content'?'content':'design')).classList.remove('hidden');
            
            // Stili bottoni
            const b1 = document.getElementById('tab-content');
            const b2 = document.getElementById('tab-design');
            if(t==='content') {
                b1.className="flex-1 py-3 text-xs font-bold uppercase text-blue-600 border-b-2 border-blue-600 bg-white";
                b2.className="flex-1 py-3 text-xs font-bold uppercase text-slate-500 hover:text-slate-700";
            } else {
                b2.className="flex-1 py-3 text-xs font-bold uppercase text-blue-600 border-b-2 border-blue-600 bg-white";
                b1.className="flex-1 py-3 text-xs font-bold uppercase text-slate-500 hover:text-slate-700";
            }
        },

        mob(mode) {
            // Mobile Nav Logic
            const ep = document.getElementById('editor-panel');
            const pp = document.getElementById('preview-panel');
            const btns = document.querySelectorAll('.mob-btn');
            btns.forEach(b => b.classList.remove('active'));

            if(mode === 'preview') {
                ep.classList.remove('active');
                pp.classList.add('active');
                document.getElementById('mob-view').classList.add('active');
                setTimeout(() => this.zoom(), 100);
            } else {
                pp.classList.remove('active');
                ep.classList.add('active');
                if(mode === 'data') {
                    this.setTab('content');
                    document.getElementById('mob-data').classList.add('active');
                } else {
                    this.setTab('design');
                    document.getElementById('mob-design').classList.add('active');
                }
            }
        },

        zoom() {
            const wrap = document.getElementById('preview-panel');
            const els = document.querySelectorAll('.cv-paper'); // Seleziona il foglio in anteprima
            if(!wrap || els.length === 0) return;
            // Prendi solo quello dentro il container di anteprima, non quello di stampa
            const el = document.querySelector('#cv-container .cv-paper');
            if(!el) return;

            const availW = wrap.clientWidth - 40;
            const scale = Math.min(availW / 794, 1); // 794px = 210mm
            el.style.transform = `scale(${scale})`;
            el.style.marginBottom = `-${1123 - (1123*scale)}px`; // Compensazione altezza
        }
    };

    // Avvio
    document.addEventListener('DOMContentLoaded', () => cvApp.init());
</script>

</body>
</html>
